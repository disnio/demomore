(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-68d74ef4"],{"0a49":function(e,t,r){var i=r("9b43"),s=r("626a"),o=r("4bf8"),a=r("9def"),n=r("cd1c");e.exports=function(e,t){var r=1==e,l=2==e,c=3==e,u=4==e,d=6==e,f=5==e||d,p=t||n;return function(t,n,m){for(var b,h,v=o(t),g=s(v),_=i(n,m,3),y=a(g.length),x=0,k=r?p(t,y):l?p(t,0):void 0;y>x;x++)if((f||x in g)&&(b=g[x],h=_(b,x,v),e))if(r)k[x]=h;else if(h)switch(e){case 3:return!0;case 5:return b;case 6:return x;case 2:k.push(b)}else if(u)return!1;return d?-1:c||u?u:k}}},1169:function(e,t,r){var i=r("2d95");e.exports=Array.isArray||function(e){return"Array"==i(e)}},"20d6":function(e,t,r){"use strict";var i=r("5ca1"),s=r("0a49")(6),o="findIndex",a=!0;o in[]&&Array(1)[o](function(){a=!1}),i(i.P+i.F*a,"Array",{findIndex:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}}),r("9c6c")(o)},"386b":function(e,t,r){var i=r("5ca1"),s=r("79e5"),o=r("be13"),a=/"/g,n=function(e,t,r,i){var s=String(o(e)),n="<"+t;return""!==r&&(n+=" "+r+'="'+String(i).replace(a,"&quot;")+'"'),n+">"+s+"</"+t+">"};e.exports=function(e,t){var r={};r[e]=t(n),i(i.P+i.F*s(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}),"String",r)}},"673e":function(e,t,r){"use strict";r("386b")("sub",function(e){return function(){return e(this,"sub","","")}})},7514:function(e,t,r){"use strict";var i=r("5ca1"),s=r("0a49")(5),o="find",a=!0;o in[]&&Array(1)[o](function(){a=!1}),i(i.P+i.F*a,"Array",{find:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}}),r("9c6c")(o)},"92cb":function(e,t,r){},b5d8:function(e,t,r){},ca10:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-row",{staticClass:"resource-box"},[r("el-col",{attrs:{span:12,offset:1}},[r("el-form",{ref:"form",attrs:{model:e.form,prop:"name",rules:e.rules}},[r("el-form-item",{attrs:{label:"名称","label-width":e.formLabelWidth,prop:"name"}},[r("el-input",{attrs:{autocomplete:"off",disabled:!!e.id},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),r("el-form-item",{attrs:{label:"显示名称","label-width":e.formLabelWidth,prop:"displayname"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.displayname,callback:function(t){e.$set(e.form,"displayname",t)},expression:"form.displayname"}})],1),r("el-form-item",{attrs:{label:"服务器地址","label-width":e.formLabelWidth,prop:"serveraddress"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.serveraddress,callback:function(t){e.$set(e.form,"serveraddress",t)},expression:"form.serveraddress"}})],1),r("el-form-item",{attrs:{label:"用户声明","label-width":e.formLabelWidth,prop:"description"}},[r("el-select",{attrs:{placeholder:"",multiple:""},model:{value:e.form.userClaimsIds,callback:function(t){e.$set(e.form,"userClaimsIds",t)},expression:"form.userClaimsIds"}},e._l(e.claimsList,function(e){return r("el-option",{key:e.value,attrs:{label:e.value,value:e.key}})}),1)],1)],1)],1),r("el-col",{attrs:{span:14}},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.editScope(0)}}},[e._v("添加域")])],1)],1),r("el-row",{staticClass:"resource-box"},[r("el-col",{attrs:{span:22,offset:1}},[e.form.scopes.length>0?r("el-table",{staticClass:"resource-table",staticStyle:{width:"100%"},attrs:{data:e.form.scopes}},[r("el-table-column",{attrs:{prop:"id",label:"ID",width:"60"}}),r("el-table-column",{attrs:{prop:"name",label:"名称"}}),r("el-table-column",{attrs:{prop:"displayname",label:"显示名称",width:"150"}}),r("el-table-column",{attrs:{prop:"description",label:"描述",width:"150"}}),r("el-table-column",{attrs:{label:"必选",width:"50"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",[e._v("\n                            "+e._s(1===t.row.required?"是":"否")+"\n                        ")])]}}],null,!1,2048930360)}),r("el-table-column",{attrs:{label:"用户声明",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.scopeArr,function(t,i){return r("div",{key:i},[e._v("\n                            "+e._s(t)+"\n                        ")])})}}],null,!1,2579258087)}),r("el-table-column",{attrs:{prop:"operation",label:"操作",wodth:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",{staticClass:"btn-box"},[r("div",{staticClass:"edit-btn",on:{click:function(r){return e.editScope(1,t.row)}}},[e._v("编辑")]),e.form.scopes&&1!==e.form.scopes.length?r("div",{staticClass:"del-btn",on:{click:function(r){return e.delScope(t.row)}}},[e._v("删除")]):e._e()])]}}],null,!1,204827421)})],1):e._e()],1)],1),r("el-row",[r("el-col",{attrs:{span:24}},[r("el-button",{on:{click:e.close}},[e._v("关闭")]),r("el-button",{attrs:{type:"primary"},on:{click:e.saveApi}},[e._v("保存")])],1)],1),r("el-dialog",{attrs:{title:("1"==e.flagCM?"编辑":"新建")+"域","close-on-click-modal":!1,visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[r("el-form",{ref:"scopeForm",attrs:{model:e.scopeForm,rules:e.scopeRules}},[r("el-form-item",{attrs:{label:"名称","label-width":e.formLabelWidth,prop:"name"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.scopeForm.name,callback:function(t){e.$set(e.scopeForm,"name",t)},expression:"scopeForm.name"}})],1),r("el-form-item",{attrs:{label:"显示名称","label-width":e.formLabelWidth,prop:"displayname"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.scopeForm.displayname,callback:function(t){e.$set(e.scopeForm,"displayname",t)},expression:"scopeForm.displayname"}})],1),r("el-form-item",{attrs:{label:"描述","label-width":e.formLabelWidth,prop:"description"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.scopeForm.description,callback:function(t){e.$set(e.scopeForm,"description",t)},expression:"scopeForm.description"}})],1),r("el-form-item",{attrs:{label:"必选","label-width":e.formLabelWidth,prop:"required"}},[r("el-radio",{attrs:{label:1},model:{value:e.scopeForm.required,callback:function(t){e.$set(e.scopeForm,"required",e._n(t))},expression:"scopeForm.required"}},[e._v("是")]),r("el-radio",{attrs:{label:0},model:{value:e.scopeForm.required,callback:function(t){e.$set(e.scopeForm,"required",e._n(t))},expression:"scopeForm.required"}},[e._v("否")])],1),r("el-form-item",{attrs:{label:"用户声明","label-width":e.formLabelWidth,prop:"claims"}},[r("el-select",{attrs:{placeholder:"",multiple:""},model:{value:e.scopeForm.scopeClaimsIds,callback:function(t){e.$set(e.scopeForm,"scopeClaimsIds",t)},expression:"scopeForm.scopeClaimsIds"}},e._l(e.claimsList,function(e){return r("el-option",{key:e.value,attrs:{label:e.value,value:e.key}})}),1)],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.resetForm}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.addScope}},[e._v("确 定")])],1)],1)],1)},s=[],o=(r("20d6"),r("6762"),r("2fdb"),r("ac6a"),r("673e"),r("7514"),r("96cf"),r("3b8d")),a=r("cebc"),n=(r("b5d8"),r("450d"),r("f494")),l=r.n(n),c=(r("ae26"),r("845f")),u=r.n(c),d=(r("1951"),r("eedf")),f=r.n(d),p=(r("016f"),r("486c")),m=r.n(p),b=(r("6611"),r("e772")),h=r.n(b),v=(r("1f1a"),r("4e4b")),g=r.n(v),y=(r("e960"),r("b35b")),x=r.n(y),k=(r("eca7"),r("3787")),w=r.n(k),F=(r("425f"),r("4105")),C=r.n(F),$=(r("a7cc"),r("df33")),S=r.n($),I=(r("672e"),r("101e")),j=r.n(I),O=(r("9d4c"),r("e450")),L=r.n(O),R=(r("10cb"),r("f3ad")),q=r.n(R),A=(r("5466"),r("ecdf")),E=r.n(A),G=(r("38a0"),r("ad41")),P=r.n(G),T=(r("f4f9"),r("c2cc")),z=r.n(T),M=(r("7a0f"),r("0f6c")),N=r.n(M),W=r("2b0e"),D=r("5c0f"),V=r("8982"),B=r("2f62");W["default"].use(N.a),W["default"].use(z.a),W["default"].use(P.a),W["default"].use(E.a),W["default"].use(q.a),W["default"].use(L.a),W["default"].use(j.a),W["default"].use(S.a),W["default"].use(C.a),W["default"].use(w.a),W["default"].use(x.a),W["default"].use(g.a),W["default"].use(h.a),W["default"].use(m.a),W["default"].use(f.a),W["default"].use(u.a),W["default"].use(l.a);var U={name:"Resource",props:["id"],data:function(){return{claimsList:[],apiList:[],form:{name:"",displayname:"",description:"",serveraddress:"",scopes:[],userClaimsIds:[]},scopeList:[],dialogFormVisible:!1,scopeForm:{name:"",displayname:"",description:"",required:1,userclaims:[],scopeClaimsIds:[]},flagCM:0,formLabelWidth:"120px",ids:0,rules:{name:[{required:!0,message:"请输入名称",trigger:"blur"},{trigger:"blur",validator:D["f"]}],displayname:[{required:!0,message:"请输入显示名称",trigger:"blur"}],serveraddress:[{required:!0,message:"请输入服务器地址",trigger:"blur"},{trigger:"blur",validator:D["h"]}],userClaimsIds:[{required:!0,message:"请选择用户声明",trigger:"blur"}]},scopeRules:{name:[{required:!0,message:"请输入名称",trigger:"blur"}],displayname:[{required:!0,message:"请输入显示名称",trigger:"blur"}],description:[{required:!0,message:"请输入描述",trigger:"blur"}],userclaims:[{required:!0,message:"请选择用户声明",trigger:"blur"}]}}},computed:Object(a["a"])({},Object(B["c"])(["oidcUser"])),mounted:function(){var e=this;this.getClaims(),this.$nextTick(function(){e.id&&e.getApi()})},methods:{getApi:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,r,i=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(V["a"])({url:"apiresources/"+this.id,method:"get"});case 3:t=e.sent,r=t.data.userclaims.map(function(e){return e.type}),this.form=Object.assign({},t.data,{userClaimsIds:r,scopes:function(){var e=t.data.scopes.map(function(e){var t=e.userclaims.map(function(e){var t=_.find(i.claimsList,function(t){return t.key===e.type});if(t)return t.value});return e.scopeArr=_.filter(t,function(e){return!_.isNil(e)}),e});return e.filter(function(e){return!_.isNil(e)})}()}),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),console.error("内部错误");case 11:case"end":return e.stop()}},e,this,[[0,8]])}));function t(){return e.apply(this,arguments)}return t}(),getClaims:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(V["a"])({url:"/dictionaries/apiclaims",method:"get"});case 3:t=e.sent,this.claimsList=t.data,e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),console.error("内部错误");case 10:case"end":return e.stop()}},e,this,[[0,7]])}));function t(){return e.apply(this,arguments)}return t}(),saveApi:function(){var e=this;this.form.createuserid=this.oidcUser.sub,this.$refs["form"].validate(function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(r){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!r){t.next=20;break}if(e.form.userclaims=_.map(e.form.userClaimsIds,function(e){return{type:e}}),_.forEach(e.form.scopes,function(t){var r=_.filter(e.claimsList,function(e){return!!_.includes(t.scopeArr,e.value)});t.userclaims=_.map(r,function(e){return{type:e.key}})}),t.prev=3,e.id){t.next=9;break}return t.next=7,Object(V["a"])({url:"apiresources",method:"post",data:e.form});case 7:t.next=11;break;case 9:return t.next=11,Object(V["a"])({url:"apiresources/"+e.form.id+"/update",method:"post",data:e.form});case 11:e.dialogFormVisible=!1,e.$router.push("/resource"),t.next=18;break;case 15:t.prev=15,t.t0=t["catch"](3),console.error("内部错误");case 18:t.next=21;break;case 20:e.$message.error("请正确填写表单");case 21:case"end":return t.stop()}},t,null,[[3,15]])}));return function(e){return t.apply(this,arguments)}}())},editScope:function(e,t){this.flagCM=e,this.dialogFormVisible=!0;var r=this;if(1==e){var i=function(){return t.userclaims.length>0?t.userclaims.map(function(e){var t=_.find(r.claimsList,function(t){return t.key===e.type});if(t)return t.key}):t.scopeArr.map(function(e){var t=_.find(r.claimsList,function(t){return t.value===e});if(t)return t.key})}();t.scopeClaimsIds=_.filter(i,function(e){return!_.isNil(e)}),this.scopeForm=Object.assign({},t)}else this.scopeForm={required:0}},addScope:function(){var e=this,t=function(){var t=e.claimsList.map(function(t){if(_.includes(e.scopeForm.scopeClaimsIds,t.key))return t.value});return t.filter(function(e){return!_.isNil(e)})}();if(1==this.flagCM){var r=this.form.scopes.findIndex(function(t){return t.id===e.scopeForm.id});-1!=r&&this.$set(this.form.scopes,r,Object.assign({},this.scopeForm,{apiresourceid:this.id,scopeArr:t}))}else this.form.scopes.push(Object.assign({id:++this.ids,apiresourceid:this.id},this.scopeForm,{scopeArr:t}));this.resetForm()},delScope:function(e){var t=this;this.$confirm("删除该域吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(o["a"])(regeneratorRuntime.mark(function r(){var i;return regeneratorRuntime.wrap(function(r){while(1)switch(r.prev=r.next){case 0:try{i=t.form.scopes.findIndex(function(t){return t.id===e.id}),-1!=i?(t.form.scopes.splice(i,1),t.$message({type:"success",message:"删除成功"})):t.$message.info("删除失败")}catch(s){console.error("内部错误")}case 1:case"end":return r.stop()}},r)}))).catch(function(e){console.log(e)})},close:function(){this.$router.push("/resource")},resetForm:function(){this.flagCM=0,this.$refs["scopeForm"].resetFields(),this.dialogFormVisible=!1}}},J=U,X=(r("f065"),r("2877")),H=Object(X["a"])(J,i,s,!1,null,null,null);t["default"]=H.exports},cd1c:function(e,t,r){var i=r("e853");e.exports=function(e,t){return new(i(e))(t)}},e853:function(e,t,r){var i=r("d3f4"),s=r("1169"),o=r("2b4c")("species");e.exports=function(e){var t;return s(e)&&(t=e.constructor,"function"!=typeof t||t!==Array&&!s(t.prototype)||(t=void 0),i(t)&&(t=t[o],null===t&&(t=void 0))),void 0===t?Array:t}},f065:function(e,t,r){"use strict";var i=r("92cb"),s=r.n(i);s.a},f494:function(e,t,r){e.exports=function(e){var t={};function r(i){if(t[i])return t[i].exports;var s=t[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,r),s.l=!0,s.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(i,s,function(t){return e[t]}.bind(null,s));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/dist/",r(r.s=96)}({0:function(e,t,r){"use strict";function i(e,t,r,i,s,o,a,n){var l,c="function"===typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=r,c._compiled=!0),i&&(c.functional=!0),o&&(c._scopeId="data-v-"+o),a?(l=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),s&&s.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(a)},c._ssrRegister=l):s&&(l=n?function(){s.call(this,this.$root.$options.shadowRoot)}:s),l)if(c.functional){c._injectStyles=l;var u=c.render;c.render=function(e,t){return l.call(t),u(e,t)}}else{var d=c.beforeCreate;c.beforeCreate=d?[].concat(d,l):[l]}return{exports:e,options:c}}r.d(t,"a",function(){return i})},4:function(e,t){e.exports=r("d010")},96:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("label",{staticClass:"el-radio",class:[e.border&&e.radioSize?"el-radio--"+e.radioSize:"",{"is-disabled":e.isDisabled},{"is-focus":e.focus},{"is-bordered":e.border},{"is-checked":e.model===e.label}],attrs:{role:"radio","aria-checked":e.model===e.label,"aria-disabled":e.isDisabled,tabindex:e.tabIndex},on:{keydown:function(t){if(!("button"in t)&&e._k(t.keyCode,"space",32,t.key,[" ","Spacebar"]))return null;t.stopPropagation(),t.preventDefault(),e.model=e.isDisabled?e.model:e.label}}},[r("span",{staticClass:"el-radio__input",class:{"is-disabled":e.isDisabled,"is-checked":e.model===e.label}},[r("span",{staticClass:"el-radio__inner"}),r("input",{directives:[{name:"model",rawName:"v-model",value:e.model,expression:"model"}],ref:"radio",staticClass:"el-radio__original",attrs:{type:"radio","aria-hidden":"true",name:e.name,disabled:e.isDisabled,tabindex:"-1"},domProps:{value:e.label,checked:e._q(e.model,e.label)},on:{focus:function(t){e.focus=!0},blur:function(t){e.focus=!1},change:[function(t){e.model=e.label},e.handleChange]}})]),r("span",{staticClass:"el-radio__label",on:{keydown:function(e){e.stopPropagation()}}},[e._t("default"),e.$slots.default?e._e():[e._v(e._s(e.label))]],2)])},s=[];i._withStripped=!0;var o=r(4),a=r.n(o),n={name:"ElRadio",mixins:[a.a],inject:{elForm:{default:""},elFormItem:{default:""}},componentName:"ElRadio",props:{value:{},label:{},disabled:Boolean,name:String,border:Boolean,size:String},data:function(){return{focus:!1}},computed:{isGroup:function(){var e=this.$parent;while(e){if("ElRadioGroup"===e.$options.componentName)return this._radioGroup=e,!0;e=e.$parent}return!1},model:{get:function(){return this.isGroup?this._radioGroup.value:this.value},set:function(e){this.isGroup?this.dispatch("ElRadioGroup","input",[e]):this.$emit("input",e),this.$refs.radio&&(this.$refs.radio.checked=this.model===this.label)}},_elFormItemSize:function(){return(this.elFormItem||{}).elFormItemSize},radioSize:function(){var e=this.size||this._elFormItemSize||(this.$ELEMENT||{}).size;return this.isGroup&&this._radioGroup.radioGroupSize||e},isDisabled:function(){return this.isGroup?this._radioGroup.disabled||this.disabled||(this.elForm||{}).disabled:this.disabled||(this.elForm||{}).disabled},tabIndex:function(){return this.isDisabled||this.isGroup&&this.model!==this.label?-1:0}},methods:{handleChange:function(){var e=this;this.$nextTick(function(){e.$emit("change",e.model),e.isGroup&&e.dispatch("ElRadioGroup","handleChange",e.model)})}}},l=n,c=r(0),u=Object(c["a"])(l,i,s,!1,null,null,null);u.options.__file="packages/radio/src/radio.vue";var d=u.exports;d.install=function(e){e.component(d.name,d)};t["default"]=d}})}}]);